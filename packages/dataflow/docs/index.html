<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dataflow Quick Start</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.11.1/styles/intellij-light.min.css">
    <script type="importmap">
        {
            "imports": {
                "highlight.js/": "https://esm.run/highlight.js/"
            }
        }
    </script>
</head>
<body>

<div class="site-header">
    <h1>Dataflow</h1>
    <a href="https://github.com/bodar/bodar.ts/tree/master/packages/dataflow"><img alt="GitHub" src="https://img.shields.io/badge/github-repo-blue?logo=github"></a>
</div>

<nav class="docs-nav">
    <a href="index.html" class="active">Quick Start</a>
    <a href="setup.html">Setup</a>
    <a href="reactivity.html">Reactivity</a>
    <a href="inputs.html">Inputs</a>
    <a href="islands.html">Islands</a>
    <a href="examples/">Examples</a>
</nav>

<h1>Quick Start</h1>

<p>Dataflow is a lightweight reactive JavaScript library heavily inspired by <a
        href="https://observablehq.com/framework/">Observable
    Framework</a>. It brings reactive programming to plain HTML pages with minimal overhead - the runtime
    (including JSX support) is only <script type="module" is="reactive">`${runtime.compressed} (${runtime.uncompressed} uncompressed)`</script>!</p>

<p>Just add a single <code>is="reactive"</code> attribute to any script tag and it becomes reactive. That's it.</p>

<p>It works like a spreadsheet: just reference a value from another reactive script tag, and the plumbing happens
    automatically. For most cases, you don't need setState, Redux, or manual subscriptions - just declarative
    dependencies. When you do need state that flows back up the graph, there's <a href="reactivity.html#mutable">mutable</a>.</p>

<p>Document order does not matter, all reactive scripts will be topologically sorted and turned into a DAG before
    execution.</p>

<div class="tip">The transformation can happen at build time, at runtime on the server, at the edge, or even client-side using a service worker. See the <a href="setup.html">Setup</a> page for details.</div>

<h2>Example</h2>

<p>A live clock using a generator that yields the current time:</p>


<div class="example">
    <script type="module" is="reactive" data-echo="html">
        `The current time is ${new Date(now).toLocaleTimeString("en-GB")}.`
    </script>
</div>

<h2>Expressions and Display</h2>

<p>A single expression automatically displays its result:</p>

<div class="example">
    <script type="module" is="reactive" data-echo="html">1 + 2</script>
</div>

<div class="note">
    <strong>Note:</strong> Unlike Observable, a semicolon on the end of a single expression does not change how it
    behaves.
    A single expression is always a singles expression regardless of optional semicolons. Prettier will not break
    anything.
</div>

<p>Statements like variable declarations don't display anything - they just define values for other blocks to use:</p>

<div class="example">
    <script type="module" is="reactive" data-echo="html">const foo = 1 + 2;</script>
    <p>The variable <code>foo</code> is defined but nothing is displayed.</p>
</div>


<p>For explicit control, use the <code>display</code> function. You can call it multiple times:</p>

<div class="example">
    <script type="module" is="reactive" data-echo="html">
        for (let i = 0; i < 5; ++i) {
            display(i);
        }
    </script>
</div>

<h2>Imports</h2>

<p>All top-level declarations (including imports) are shared within the same <a href="reactivity.html#reactive-scope">reactive scope</a>. By default, the whole page is a single scope. For isolated scopes, see <a href="islands.html">Reactive Islands</a>.</p>

<p>Common APIs like <code>display</code>, <code>view</code>, <code>input</code>, <code>mutable</code>, <code>now</code>, etc. are implicitly available - no import needed. Just use them directly in any reactive script.</p>

<div class="note">
    <strong>Note:</strong> All the examples from now on will not show the enclosing reactive script tag
</div>

<h2>DOM Nodes</h2>

<p>If an expression evaluates to a DOM node, the node is inserted into the page. Use this to create dynamic content.</p>

<div class="example">
    <script type="module" is="reactive" data-echo>document.createTextNode("[insert chart here]")</script>
</div>

<h2>JSX</h2>

<p>JSX is supported for creating DOM elements with a familiar syntax. Under the hood, JSX compiles directly to native
    DOM methods using the <a href="https://jsr.io/@bodar/jsx2dom">@bodar/jsx2dom</a> library - no virtual DOM, no
    framework overhead.</p>

<div class="note">
    <strong>Note:</strong> Observable Framework uses template literals (<code>html`...`</code>) for HTML. Dataflow uses JSX which provides better IDE support, type checking, and a more React-like developer experience.
</div>

<p>For example, here's a component that displays a greeting:</p>

<div class="example">
    <script type="module" is="reactive" data-echo>
        const greeting = (name) => <i>Hello {name}!</i>
    </script>
    <script type="module" is="reactive" data-echo>greeting("World")</script>
</div>

<p>JSX attributes work as expected, including dynamic values:</p>

<div class="example">
    <script type="module" is="reactive" data-echo>
        const color = "blue";
    </script>
    <script type="module" is="reactive" data-echo>
        <span style={`color: ${color}; font-weight: bold`}>Styled with JSX</span>
    </script>
</div>

<h2>Reactive Inputs</h2>

<p>The <code>view</code> function creates reactive inputs. When the input changes, dependent code re-runs:</p>

<div class="example">
    <script type="module" is="reactive" data-echo>
        const name = view(<input name="name" type="text" value="World"/>);
    </script>
    <script type="module" is="reactive" data-echo>`Hello, ${name}!`</script>
</div>

<p>See the <a href="inputs.html">Inputs</a> page for more input types and patterns, and the <a href="reactivity.html">Reactivity</a> page for generators, invalidation, and other reactive patterns.</p>

<script type="module" is="reactive">
    const runtime = fetch('https://dataflow.bodar.com/runtime.js')
        .then(async r => {
            const compressed = r.headers.get('content-length');
            const uncompressed = (await r.text()).length;
            return {
                compressed: `${Math.round(compressed / 1024)}KB`,
                uncompressed: `${Math.round(uncompressed / 1024)}KB`
            };
        });
</script>

<script type="module">
    import hljs from 'highlight.js/lib/core.js';
    import javascript from 'highlight.js/lib/languages/javascript';
    import xml from 'highlight.js/lib/languages/xml';

    hljs.registerLanguage('javascript', javascript);
    hljs.registerLanguage('xml', xml);
    hljs.highlightAll();
</script>

</body>
</html>
